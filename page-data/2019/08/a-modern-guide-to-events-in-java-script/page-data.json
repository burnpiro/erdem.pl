{"componentChunkName":"component---src-templates-post-template-js","path":"/2019/08/a-modern-guide-to-events-in-java-script","result":{"data":{"markdownRemark":{"fields":{"slug":"/2019/08/a-modern-guide-to-events-in-java-script","tagSlugs":["/tag/dom/","/tag/javascript/","/tag/events/"],"readTime":{"text":"22 min read","minutes":21.9}},"frontmatter":{"description":"How Events are propagating through DOM elements? Is there a way to use it to our advantage?","tags":["DOM","Javascript","Events"],"date":"2019-08-19","title":"A modern guide to Events in JavaScript"},"html":"<h3 id=\"what-are-events\"><a href=\"#what-are-events\" aria-label=\"what are events permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What are Events?</h3>\n<blockquote>\n<p>Events are objects and implement the <a href=\"https://dom.spec.whatwg.org/#interface-event\">Event interface</a></p>\n</blockquote>\n<p>Those objects are dispatched by the user agent (or the application itself) and handled by the <a href=\"https://dom.spec.whatwg.org/#concept-event-listener\">Event Listener</a>. Events are responsible for handling user interactions or network activity. There are different types of events but you can check then on <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Event#Introduction\">MDN</a> if you want. We have to focus on how events are propagating through the DOM.</p>\n<h3 id=\"event-propagation\"><a href=\"#event-propagation\" aria-label=\"event propagation permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Event propagation</h3>\n<p>First, we have to create some simple DOM to explain event propagation</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>container<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>dataContainer<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>clickedData<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>dataSubmitter<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Add Data<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 521px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 94.24184261036469%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAAC5ElEQVQ4y51UTUwTURB+3WIoVA6a6F3Dn4qJiTdPJiZ64AJ6MDHhwsEgF/WABxIT48GLfxwUhBhQ4SAHjbYV6K/dbYvRFgFBpJTStED/d7fbUrrtth3fbmmNEkjrJJNv38zO9+a9mXkI7Uhs9ZWEjndtB3KsbUlgbMB49duw7YAsTalEX56zE5mICZUlsdXXEs5qOmsgYWcBliHg0gLAOuRjX+yiD5ILhBAlyyNkXSMSjncjhLNoz9JklxA1X8+zVBcf0l8QfQJNyfigFpUt6gd7+yD5E1Usi4aevQkhXxlZ8Q77biAZxKdvATf9JObT9QHveJxjqA6JNDMnS4f05RHSK4U7hNyb2pBby+didohvUgDJWYymBdG3PKsqvyhzpocSZp035YlN49uoRzvDeHVkZG1qPuk3SE7Pooo4e6ZxfyKAH2h85P4ue60cVYtYV40U5SQ0OnQXcy3hu9ugCNxssnu93fKmxmMHT59qUJ5obqhTKuuKRDUKhUIpYlGPHjlc23KyXtncdFwpxty53VklckR9NuLfjWR/Fcqnk9YdVy+WbM8e9cj2TZUPf37Ph6nJ+KZRz20YDOkI9QmrNh3StYh+zjdRIoBEIYNU0HApFSbNfITS4Bi9GIs5JvgwOYFAmIetoBXifgpSkWngxMpmFwHi1nYxOB0xy4uEfqe6SsSQS90L/Dz+l4SE3wKJgEXqCIH5Cgi3wVM8qy9SIfMg1qEsY+vP0tZBPGL1EmHYUMoQjyRRsBnPCbRlGD8izwXaOpCJWgZwHFZr//4dkJjZZctzMzL0v8J4VH+tBdZRQOabLLu1IoeUh8htuQkhsUrkkm4CUmsEyoT1rQBzl+PrU9cYj6YDYKENWPMVzvvhkFSAwOSfF2lluLCR8yXi3GOIWxsrYOl7FB+L/w7sOonVDLTXBEG3HkDARWHJVimbKCmv6Fi4beJBlyYXcmmEgFMtbPz6KCQDJsjRxvM7BSAq4fsNdDffZJrLgxMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Object\"\n        title=\"Object\"\n        src=\"/static/40b7f0e843a117a6e441a60fdcafbfe3/2ff8c/tree.png\"\n        srcset=\"/static/40b7f0e843a117a6e441a60fdcafbfe3/e4891/tree.png 240w,\n/static/40b7f0e843a117a6e441a60fdcafbfe3/0ce91/tree.png 480w,\n/static/40b7f0e843a117a6e441a60fdcafbfe3/2ff8c/tree.png 521w\"\n        sizes=\"(max-width: 521px) 100vw, 521px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>To handle events we need to add some Event Listeners. To do that in VanillaJS we have to get DOM element and call <code class=\"language-text\">addEventListener</code> on it. DOM Element is implementing EventTarget interface and because of that, we have access to <code class=\"language-text\">addEventListener(typeundefined callbackundefined options)</code> and <code class=\"language-text\">removeEventListener(typeundefined callbackundefined options)</code> methods.</p>\n<ul>\n<li><strong>type</strong> - the name of the event</li>\n<li><strong>callback</strong> - function to be called</li>\n<li><strong>options</strong> - object to change default listener behavior</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> button <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dataSubmitter'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nbutton<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'clicked'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>After calling <code class=\"language-text\">addEventListener</code> we’ve added a listener to <strong>event listener list</strong> on that element (button). This list is a list of zero or more event listeners which means you can add more listeners for the same event.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> button <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dataSubmitter'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nbutton<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'clicked first'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nbutton<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'clicked second'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>In this case when <code class=\"language-text\">click</code> event is dispatched, listeners will be called in the order in which they were assigned (we’ll see <code class=\"language-text\">clicked first</code> and then <code class=\"language-text\">clicked second</code> in the console).</p>\n<p>Everyone knows what will happen after clicking on our button (2 console logs) but to show how the event is propagating through our DOM tree we have to add more listeners</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 581px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 84.50946643717728%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsSAAALEgHS3X78AAADm0lEQVQ4y5VTX2xaVRg/0NaVCVsXp9vUzThdky7T2dotanzz1fhkjK/GBx+W+LT4YjRZfDFxe1k0dksaE03MVtfZ0nIpcO+Fe+H2woC1hUr5cylcuECBUsqfdhRKP8892Nlm3cO+5MvvnO/v+X3nHCREOS3C4onzn1B+60/5vGCFTR+sp5ltaC1Ae831t+pvr7u7VEwEFQ3aL6d0vbqXMJ7EqkH2RRsJdIXZL+4yY0YlK/jaZc92PDBRb697ACru+6p/p+LtkkM5UuwfURqMzytfizb/1e+uXvsQmwy9h3rPYewjLRg/87gr5H7WtYq2wbXlyeF2iR6sK8ZXVHs9PYOUpQJhExaTn8XnFD4xl50RTL6PVNsRw9E3MLyGuICDFOJDQtc0e68XHSBQ5khDf85L9pxsMYgKf8Yls6fzkDj0RAKzYPv/hDDRA7A48IC9PQwwfx42hJMd+0MULoTJeLyyeGUhM1ebV/wrk8L45+rs9Ab9EMZzyBVxkCAxxn1JeWcoOc0FWyUBqhkHwIYfNlfsZtVfkukuIW4nTa2hSZ09OvMiG6GOj5p+IayOHe9Tx6FFTNBC5sIv0R/fYcZ+TCTZ8UzYlE+FphLJReN6NcOMqv700jSJcyf5J0cCsGdT+xPNBYzavQFB4dczAKEXJN/oq1A36TpJIeQMjBO/NzqBIklKuxid1AIkNLDBoFTgD030we19jTB1zWGMPZ31rg0992b/2cNDl4f0lz64pB9+b1j/en//btyu7jnhxj0dQFY/cv2rl5uZO0cB/Efg0d3udGaNUInLvObAmwfeALDy/G83r5yqxH/vwwwM0PqrG+EZRYvL1uVczJzCKOHhFxoFx/dqkhTvXJgrZn+f8kz9IEr8txPi1DdRmRspJa3J1aRNykRMqXzcIuF1sZahr6GtogvKaQeUU3ZYTTIA9YfQKHC3yDeTZwkdIcZ9ahKneLfkooyz08Zwgpuv53j8PR0kp5igAWp+qCj0KH609HnY8VzMhccuQ4W9CA3XYDNvPtGhZUaemPtgyo+cb8OW8BY0iV7Aee/gWifQ06S95ny8npV4DT5h96wkdLM+qgedhqfmoeYKdRYg0O93jLwLVccAbIsDVfn+MdW3lbfsi90q0B3M06i1ymtbJSdW/j91aptFVoMaBb6ejZo3lQjVSIWma9UsBztl4UbnjS5o0bNKo+hsl2QWSjIDuZilDVUftMvCzc6TCj5zwX8BCV46JJuSiIQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Object\"\n        title=\"Object\"\n        src=\"/static/2314378eecfe47a943041e1e94cc9ebe/447d2/click-bubble.png\"\n        srcset=\"/static/2314378eecfe47a943041e1e94cc9ebe/e4891/click-bubble.png 240w,\n/static/2314378eecfe47a943041e1e94cc9ebe/0ce91/click-bubble.png 480w,\n/static/2314378eecfe47a943041e1e94cc9ebe/447d2/click-bubble.png 581w\"\n        sizes=\"(max-width: 581px) 100vw, 581px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>And now after user interaction event is <strong>bubbled</strong> through the DOM upwards</p>\n<p><img src=\"/b7d02691c5db7f12c0cd508750c73a1b/bubble.gif\" alt=\"Object\"></p>\n<p>This process is called <strong>bubbling</strong> and it’s easy to understand, but it’s not the whole path. Every event starts its path from the top of the tree. This process is called <strong>capturing</strong> and to access events in the <strong>capture</strong> phase we have to create listeners with extra options passed as the third argument.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> container <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'container'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncontainer<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span>\n  <span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"container capture 'click'\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    capture<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">capture: true</code> informs our listener to listen for events in <strong>phase 1 or 2</strong>. Every event has 3 phases:</p>\n<ul>\n<li><strong>Capture (1)</strong> - going down the tree</li>\n<li><strong>On Target (2)</strong> - that’s self-explanatory</li>\n<li><strong>Bubble (3)</strong> - going up the tree</li>\n</ul>\n<p>Now let’s see how our event is propagating (numbers next to event type is the order in which event listener is added).</p>\n<p><img src=\"/0c0a9964fa9613cb82d7902516bcaa37/capture.gif\" alt=\"Object\"></p>\n<p>After click event is dispatched it starts at the <code class=\"language-text\">body</code> level with <code class=\"language-text\">eventPhase === 1</code>. After that is propagates through the tree until it reaches its target (button).</p>\n<p>At the button level phase change to <strong>2</strong> and we can spot unusual behavior. If you look closely on the order in which listeners are called (<code class=\"language-text\">button</code>), first we’re calling event listeners which are responsible for <strong>bubbling</strong> event and then listener responsible for <strong>capturing</strong>. It might seem weird at the beginning, but at the <code class=\"language-text\">button</code> level, our event is not in any of those phases. Because of that, our listeners are executed in order of creation. In <strong>On Target</strong> phase, listener type doesn’t matter.</p>\n<p>After that our event is bubbling in the same way as in the previous example.</p>\n<h3 id=\"how-to-stop-events-from-propagating\"><a href=\"#how-to-stop-events-from-propagating\" aria-label=\"how to stop events from propagating permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How to stop events from propagating?</h3>\n<p>Sometimes we want our events to top at the specific point of the tree. To do that we need to use <code class=\"language-text\">e.stopPropagation()</code> or <code class=\"language-text\">e.stopImmediatePropagation()</code>. Those functions are preventing other listeners from being called with the same event.</p>\n<h4 id=\"stoppropagation\"><a href=\"#stoppropagation\" aria-label=\"stoppropagation permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>stopPropagation()</h4>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> button <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dataSubmitter'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nbutton<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'clicked first'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  e<span class=\"token punctuation\">.</span><span class=\"token function\">stopPropagation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nbutton<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'clicked second'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nbutton<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span>\n  <span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"button capture 'click'\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    capture<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><img src=\"/7997903c10d5f1a683882d7323c26d6c/stop-propagation.gif\" alt=\"Object\"></p>\n<p>Even if we call <code class=\"language-text\">stopPropagation()</code> inside the first listener, all listeners assigned to current elements are called. Event is not propagated into another <code class=\"language-text\">EventTarget</code>. We can call <code class=\"language-text\">stopPropagation()</code> inside any of our listeners on the way, it doesn’t have to be target or even <strong>bubbling</strong> phase. If you want to prevent the event from reaching the target you can call <code class=\"language-text\">stopPropagation</code> in one of the listeners listening on the <strong>capture</strong> phase.</p>\n<h4 id=\"stopimmediatepropagation\"><a href=\"#stopimmediatepropagation\" aria-label=\"stopimmediatepropagation permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>stopImmediatePropagation()</h4>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> button <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dataSubmitter'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nbutton<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'clicked first'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  e<span class=\"token punctuation\">.</span><span class=\"token function\">stopImmediatePropagation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nbutton<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'clicked second'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nbutton<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span>\n  <span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"button capture 'click'\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    capture<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><img src=\"/e556b4c62b47c2e87685fa124b33f0a2/stop-immediate-propagation.gif\" alt=\"Object\"></p>\n<p>You’ve probably already spotted the difference. <code class=\"language-text\">stopImmediatePropagation</code> is stopping propagation on the same listener in which it’s called. If we call it inside <code class=\"language-text\">click (2)</code> then propagation stops at <code class=\"language-text\">click (2)</code> and doesn’t execute <code class=\"language-text\">click (3)</code>. You should be aware of that difference when dealing with multiple listeners on your elements.</p>\n<h4 id=\"preventdefault\"><a href=\"#preventdefault\" aria-label=\"preventdefault permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>preventDefault()</h4>\n<p>It’s a good time to mention <code class=\"language-text\">preventDefault</code> method. It’s quite common in modern frameworks to do something like that:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">e<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ne<span class=\"token punctuation\">.</span><span class=\"token function\">stopPropagation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>A lot of people are doing that without even knowing why. You know that <code class=\"language-text\">stopPropagation()</code> is stopping an event from going through the event listeners. <code class=\"language-text\">preventDefault</code> on the other hand, is telling the browser not to execute its default behavior.</p>\n<iframe src=\"https://codesandbox.io/embed/awesome-wildflower-z3wn2?fontsize=14\" title=\"awesome-wildflower-z3wn2\" allow=\"geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media\" style=\"width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;\" sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"></iframe>\n<p>If we call <code class=\"language-text\">preventDefault()</code> on <code class=\"language-text\">click</code> event from checkbox then browser won’t change our checkbox to the selected state. We can handle our event manually (e.g. apply custom action instead). That’s also helpful when it comes to submitting the form. In most of the popular libraries, we don’t actually want form element to send HTML from. We want to handle form data manually, apply validation, parsing and add some extra data before sending.</p>\n<h3 id=\"dispatching-events-manually\"><a href=\"#dispatching-events-manually\" aria-label=\"dispatching events manually permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dispatching events manually</h3>\n<p>I’ve said before, event doesn’t have to be created by the browser, we can create them. To do that we have to create new <code class=\"language-text\">CustomEvent</code> instance, and <code class=\"language-text\">dispatchEvent</code>. <a href=\"https://dom.spec.whatwg.org/#interface-customevent\"><code class=\"language-text\">CustomEvent</code></a> is basically the same standard <code class=\"language-text\">Event</code> but has an additional attribute in <code class=\"language-text\">options</code> object called <code class=\"language-text\">details</code>. That attribute is used to store custom data.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> clickedData <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'clickedData'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> dataEvent <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">CustomEvent</span><span class=\"token punctuation\">(</span><span class=\"token string\">'addData'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  detail<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> test<span class=\"token punctuation\">:</span> <span class=\"token string\">'test2'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nclickedData<span class=\"token punctuation\">.</span><span class=\"token function\">dispatchEvent</span><span class=\"token punctuation\">(</span>dataEvent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Let’s add listeners to our tree to listen for our custom event</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 771px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.683527885862524%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAADCElEQVQ4y61TS2gTURSdpl+TikZLqxZBFJWCaAURpCiKtigurNBSFTcu/Cz9LHUlqKALV1WpFaxGKq35TJL5ZT6ZzEwmk6RJO0mT2F9im9gmbWqa/mu0z2lcuRBBPfC4HN49l/sO50GQAlJGazpx3UsTp39h4PStlBt+k8tIIDctApALgKAovqVMrkekkX1MwVyrwyodgX7FluKi4q1KLc8z7iNdRfUSF+k+ooWSyWaxn7y8nHa2zYzRnbkvYocsuG4xZukaY+avM2bhpoB5963phn3x24M9ox8MHdYzCtVq1JrdEBumoL9FWB48OdA/cnUoFNu5xg/sry3OXzhjdFH/tF8rpzzanqR34+CkWLGSZo/Hw8bG1QxfPxHp2xoSJjZEfXHtiC+xadA/Vram84977vWO95BkAG1QaJmmXLMnP5AO4LVd5HsE5g2wiTcaaa+FnEsJ4FvGDcC8H/gcvNNmEAz4B9pI6BnGbhbXnghRXkxD9lnW6/D2/GZl60oL8wNtIaTUHsSrxYhtu3OArg5G6R3pT1hzZpS4nI5hl6K9nl2cVa6SbL5tks1fzaMezfLswwIQZVUAAAiAsFLHVNA/4Pfi58YH6oN3zhZPJYi9i0m2cai3u3khaT+/nOKO6p7q1KzBVi6jgSK9S6dqMz9Vd9ieqR+8v1u2kGTqfvZ3NS2l2MbZOHP4yuknJRDigsluu8E6MESNgawHLCR5sJqVQGqY+04aOZSCHbxk7TuEhUw1iMtiR1xmAnVb8dEhfHV1xg3mJ7h8fyLCLtGwiEJ8hKrsklBtKk7XfpsWWqaiWMvKlOPCUko4JWLBzSLhrXKafCWuSaaICzMVTNC2mZBx7XzSfiKX5pqWJ9lzX9OO5sUJvo6zRDZC/x0w313/Gnt37FOMvDGboNtjQVP7VBR/lY3z9y2d1AklKg084qnMx4tjCggfUoAqJ/OZVikeFs6NM4WLSXthNs6pGNgHQYgEG7vs+s6RKDMMVmQwnxQUTzxgJi59VTzspmHO6sR68n+XQ9x/jMYPQEjcNBXMCJ8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Object\"\n        title=\"Object\"\n        src=\"/static/41b903a66408abf0322f0bd031463bc1/36e7e/add-data-event.png\"\n        srcset=\"/static/41b903a66408abf0322f0bd031463bc1/e4891/add-data-event.png 240w,\n/static/41b903a66408abf0322f0bd031463bc1/0ce91/add-data-event.png 480w,\n/static/41b903a66408abf0322f0bd031463bc1/36e7e/add-data-event.png 771w\"\n        sizes=\"(max-width: 771px) 100vw, 771px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>What will happen when our code is executed?</p>\n<p><img src=\"/e46550490b72700b64ef34326b7cbdff/data-no-bubble.gif\" alt=\"Object\"></p>\n<p>Wait for the second, why there is no bubbling?! In our case event stays on <strong>On Target</strong> phase. Reason for that is because by default all events created using <code class=\"language-text\">new CustomEvent()</code> have <code class=\"language-text\">bubbles</code> set to <code class=\"language-text\">false</code>.</p>\n<p>To enable bubbling for this event we have to create it with <code class=\"language-text\">options</code> object:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">new</span> <span class=\"token class-name\">CustomEvent</span><span class=\"token punctuation\">(</span><span class=\"token string\">'addData'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  bubbles<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  detail<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> test<span class=\"token punctuation\">:</span> <span class=\"token string\">'test2'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><img src=\"/675d861ccd7b8cfea6c4d6f4c68e971e/data-bubble.gif\" alt=\"Object\"></p>\n<blockquote>\n<p>Using <code class=\"language-text\">CustomEvent</code> is not mandatory. If you want you can create instance of <code class=\"language-text\">new Event()</code> and use it for your propagation.</p>\n</blockquote>\n<h3 id=\"when-we-might-want-to-use-custom-events\"><a href=\"#when-we-might-want-to-use-custom-events\" aria-label=\"when we might want to use custom events permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>When we might want to use custom events?</h3>\n<p>I think sending data to elements it’s obvious. A good example to show you why you might want to hook up into event propagation is React’s HOCs (Higher Order Components). Imagine an application with multiple layers of logic wrapped around your form. It might look sth like:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>app<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>addUserData<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>prefillAfterReset<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span><span class=\"token punctuation\">></span></span>\n        {...}\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>In this case, we can hook into form’s <code class=\"language-text\">submit</code> and <code class=\"language-text\">reset</code> events even before they reach our form component and add/modify data on submitting/resetting the form. I’m not saying to implement such behavior because there are better ways to do it.</p>\n<p>If you want to play with events please check this sandbox</p>\n<iframe src=\"https://codesandbox.io/embed/blissful-wilson-6ce25?fontsize=14\" title=\"blissful-wilson-6ce25\" allow=\"geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media\" style=\"width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;\" sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"></iframe>"}},"pageContext":{"slug":"/2019/08/a-modern-guide-to-events-in-java-script"}}}